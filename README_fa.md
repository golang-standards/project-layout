# چیدمان استاندارد پروژه ی Go

ترجمه ها :

* [한국어 문서](README_ko.md)
* [简体中文](README_zh.md)
* [正體中文](README_zh-TW.md)
* [简体中文](README_zh-CN.md) - ???
* [Français](README_fr.md)
* [日本語](README_ja.md)
* [Portuguese](README_ptBR.md)
* [Español](README_es.md)
* [Română](README_ro.md)
* [Русский](README_ru.md)
* [Türkçe](README_tr.md)
* [Persian](README_fa.md)



 ## &#x202b; بررسی اجمالی

این یک طرح اولیه برای پروژه های Go است. توجه داشته باشید که از نظر محتوا تمرکز فقط روی اصول اولیه است چون فقط بر روی چیدمان کلی تمرکز میکنه و نه اون چیزی  شما در داخل اون فایل به چه نحوی هندل کنید. به طور کلی در مورد اصول اولیه است چون مسائل را از بالا میبینه و به جزئیات زیادی در مورد اینکه چطوری میتویند پروژه را حتی بیشتر ساختار بدید وارد نمیشه. به عنوان مثال، سعی نمیکنه ساختار پروژه ای را که می خواهید با چیزی مثل Clean architecture پوشش بده.

&#x202b;این  **`این یک استاندارد رسمی تعیین شده توسط تیم اصلی توسعه دهنده‌ی Go نیست`** . این مجوعه از الگوهای رایج قدیمی و  در حال گسترش اکوسیستم go هست و بعضی از این الگوها محبوبترن. همچنین چند بهبود جزیی در کنار پشتیانی چند پوشه مورد پشتیانی برای هر پروژه‌ای که به اندازه کافی بزرگه، واقعا لازمه. توجه داشته باشید که تیم **core Go مجموعه‌ای عالی از دستورالعمل‌های کلی در مورد ساختار پروژه‌های Go** و این راهتما شامل نکاتی برای تنظیمان اولیه و import و نصب آن ارائه میکنه. برای جزئیات بیشتر به صفحه ['سازماندهی یک ماژول Go'](https://go.dev/doc/modules/layout) در مستندات رسمی Go مراجعه کنید. این شامل الگوهای دایرکتوری «internal» و «cmd» (توضیح داده شده در زیر) و باقی اطلاعات مفید است.

&#x202b;**`اگر در حال یادگیری زبان Go هستید یا در حال ساخت یک PoC (Proof of Concept یا اثبات فرضیه) و یا یک پروژه ی ساده برای خودتان ٬این چیدمان زیاد از حد است . بجای آن با یک چیز ساده تر شروع کنید (یک فایل 'main.go' و 'go.mod' هم بیش از حد نیاز شماست ) .`** همین طور که پروژه ی شما در حال گسترش است به یاد داشته باشید که کد شما ساختار خوبی پیدا کرده است در غیر این صورت در انتها با یک کد نا مرتب با تعداد زیادی وابستگی hidden و global state ها مواجه میشید. هر چقدر تعداد افراد بیشتری روی پروژه ی شما کار میکنند به structure بهتری نیاز دارید. در همین زمانه که معرفی یک روش متداول برای مدیریت بسته ها/کتابخانه ها مهم است. وقتی که یک پروژه‌ی open source انجام میدهید و یا کدی مینوسید که افراد دیگری هم کد شما را در پروژه ی خود import میکنند آن زمان مهمه که پکیج ها و کد های خصوصی (بخوانید internal) داشته باشید . این ریپازیتوری را clone کنید هر چیز که نیاز دارید را نگه دارید و بقیه را حذف کنید . هر چیزی که اینجا قرار گرفته شده لزوما به این معنی نیست که باید حتما از اون استفاده کنید. قطعا همه این الگو ها برای همه‌ی پروژه ها مورد نیاز نیستند . حتی الگو‌ی `vendor` هم در همه پروژه‌ها رایج نیست.

&#x202b;با استفاده از Go ورژن ۱.۱۴ [`Go Modules`](https://github.com/golang/go/wiki/Modules) بالاخره آماده production هستیم . از [`Go Modules`](https://blog.golang.org/using-go-modules)  استفاده کنید مگر اینکه دلیل خاصی برای استفاده نکردن داشته باشید اگر استفاده میکنید دیگه لازم نیست نگران $GOPATH باشید و یا جایی که پروژه را ذخیره میکنید. فایل پایه‌ای `go.mod` در repo شما فرض میکنه که پروژه شما در گیتهاب host میشه ولی این الزامی نیست . مسیر modules ٬ هر چیزی میتونه باشه اگر چه که اولین بخش مسیر باید یک نقطه در نام خود داشته باشد (در نسخه ی فعلی Go دیگر مجبور به این کار‌ها نیستید ولی اگر از نسخه های کمی قدیمی تر استفاده میکنید اگر بیلد شما با خطا مواجه شد، تعحب نکنید).اگر میخواهید بیشتر درباره آن بخونید ٬  این issue هارو بررسی  کنید [`37554`](https://github.com/golang/go/issues/37554) و [`32819`](https://github.com/golang/go/issues/32819) .

&#x202b;این چیدمان پروژه از عمد عمومی است و سعی در تحمیل ساختار خاصی را در Go ندارد .

&#x202b;این Repository حاصل تلاش جمعی است. اگر الگو ی جدیدی در نظر دارید یا اینکه الگوی قبلی نیاز به بروزرسانی داره یک issue بسازید.

&#x202b;اگر کمکی در زمینه نام گذاری، فرمت کردن و یا استایل نیاز دارید میتونید از اجرا  [`gofmt`](https://golang.org/cmd/gofmt/) یا [`staticcheck`](https://github.com/dominikh/go-tools/tree/master/cmd/staticcheck) استفاده کنید. linter استاندارد قبلی go حالا دیگه منسوخ شده و دیگه maintain نمیشه و استفاده از linter های که مثل staticcheck همچنان maintain میشن، توصیه میشه. همچنین این دستورالعمل ها و راهنما های سبک کد زدن Go را حتما بخونید:
* https://talks.golang.org/2014/names.slide
* https://golang.org/doc/effective_go.html#names
* https://blog.golang.org/package-names
* https://github.com/golang/go/wiki/CodeReviewComments
* [دستورالعمل سبک کد زنی Go](https://rakyll.org/style-packages) (rakyll/JBD)

&#x202b;برای اطلاعات بیشتر به این مقاله رجوع کنید : [`Go Project Layout`](https://medium.com/golang-learn/go-project-layout-e5213cdcfaa2).

&#x202b;اطلاعات بیشتر درباره نام گذاری و سازمان دادن به پکیج ها و همچنین سایر توصیه های ساختاری کد در go:

* [GopherCon EU 2018: Peter Bourgon - Best Practices for Industrial Programming](https://www.youtube.com/watch?v=PTE4VJIdHPg)
* [GopherCon Russia 2018: Ashley McNamara + Brian Ketelsen - Go best practices.](https://www.youtube.com/watch?v=MzTcsI6tn-0)
* [GopherCon 2017: Edward Muller - Go Anti-Patterns](https://www.youtube.com/watch?v=ltqV6pDKZD8)
* [GopherCon 2018: Kat Zien - How Do You Structure Your Go Apps](https://www.youtube.com/watch?v=oL6JBUk6tj0)



## &#x202b; پوشه های Go

### `/cmd`

&#x202b;برنامه های اصلی برای این پروژه

&#x202b;نام پوشه برای هر برنامه باید با نام فایل اجرایی (executable) که میخواید داشته باشید یکی باشه (بطور مثال `/cmd/myapp`).

&#x202b;داخل این پوشه کد زیادی قرار ندید. اگر فکر میکنید که کدتون میتونه داخل پروژه های دیگر هم ایمپورت و استفاده شه اون را در پوشه‌ی `/pkg` قرار بدید. اگر کد قابل استفاده مجدد نیست یا اینکه نمیخواهید دیگران از آن استفاده کنند اون رو داخل پوشه `/internal` قرارش بدید . اگر بفهمید بقیه دقیقا چه کاری میتونن انجام بدن شگفت زده میشید بنابراین در رابطه با کاری که میشه انجام داد صریح باشید!

&#x202b; داشتن یک فایل `main` که کدهارو از پوشه `/internal` و `/pkg`  ایمپورت میکنه و هیچ کار دیگری انجام نمیده بسیار مرسومه.

&#x202b;مثال های   [`/cmd`](cmd/README.md) رو ببینید .

### `/internal`

&#x202b;برنامه‌ها و کدهای private یا خصوصی. این کدی است که شما نمیخواید دیگران از اون  توی کد یا برنامه‌شون استفاده بکنن. توجه کنید که این الگو توسط خود کامپایلر Go اعمال شده است . برای اطلاعات بیشتر رجوع کنید به  1.4 [`release notes`](https://golang.org/doc/go1.4#internalpackages) . و اینکه که شما فقط به یک پوشه `internal` در روت پروژه محدود نیستید . شما میتوانید در پوشه بندی پروژه‌ی خودتون بیشتر از یک پوشه‌ی `internal` داشته باشید.

&#x202b;همچنین به صورت اختیاری کمی sturcturies اضافی به پکیج های internal خودتون اضافه کنید تا کدهای داخلی اشتراک گذاری شده و اشتراک گذاری نشده خود را جدا کنید. در کل نیازی نیست (مخصوصا برای پروژه های کوچک), اما خوبه که سرنخ های از نحوه ی استفاده از کد مد نظر داشته باشید. کد برنامه ی اصلی شما میتونه در پوشه `/internal/app` قرار بگیره (مثال `/internal/app/myapp`) و کد مشترک این برنامه ها در  `/internal/pkg` قرار بگیرد (مثال `/internal/pkg/myprivlib`).

### `/pkg`

&#x202b;کد کتابخانه هایی که استفاده اش توسط برنامه های دیگه هم مشکلی نداره (مثلا `/pkg/mypubliclib`). پروژه های دیگه با اطمینان از اینکه این کدها درست کار میکنند این کدهارو import میکنند پس قبل از اینکه چیزی در این پوشه قرار بدید حتما از کارکردشان مطمئن باشید :-) قابل ذکره که پوشه‌ی  `internal` راه بهتری برای مطمئن بودن از اینکه دیگران نمیتونن اون کد را ایمپورت کنند هستند ٬ چون توسط خود Go اعمال شده. پوشه ی  `/pkg` همچنان راه خوبیه چون صریحا بیان میکنه که کد داخل آن قابل استفاده برای دیگران است. مقاله ی [`I'll take pkg over internal`](https://travisjeffery.com/b/2019/11/i-ll-take-pkg-over-internal/) نوشته شده توسط  Travis Jeffery بررسی خوبی از دایرکتوری های `pkg` و `internal` و زمانی که ممکنه استفاده از آنها منطقی باشد ارائه میده.
همچنین راهی برای گروه بندی کردن کد Go در یک مکان ، برای زمانی که پوشه ی اصلی پروژه ی شما حاوی تعداد زیادی فایل (component) و پوشه غیر Goی است که اجرای ابزارهای مختلف Go را آسون تر  میکنه. (همانطور که در این گفتگو ‌ذکر شده: [`Best Practices for Industrial Programming`](https://www.youtube.com/watch?v=PTE4VJIdHPg) from GopherCon EU 2018, [GopherCon 2018: Kat Zien - How Do You Structure Your Go Apps](https://www.youtube.com/watch?v=oL6JBUk6tj0) and [GoLab 2018 - Massimiliano Pippi - 

&#x202b;پوشه ی  [`/pkg`](pkg/README.md) رو ببینید اگر میخواهید بدونید کدام یک از repo معروف Go از این الگوی چیدمان استفاده میکنند. این یک الگوی چیدمان رایج است، اما همه اون رو نپذیرفتن و بعضی ها در جامعه ی Go اون را توصیه نمی‌کنند.

&#x202b; کاملا منطقیه اگر پروژه شما کوچیکه و از این الگو استفاده نکنید چو اگر پروژه ی شما کوچیکه اضافه کردن یک پوشه چندان ارزشی ایجاد نمیکنه (مگر اینکه خودتون بخواید :-)). وقتی پروژتون به اندازه کافی بزرگ شد و دایرکتوری root شما خیلی شلوغ شد، بهش فکر کنید (مخصوصا زمانی که file های زیادی به زبانی غیر از Go دارید).

&#x202b;ریشه یابی نامگذاری پوشه `pkg` : سورس های قدیمی Go از `pkg` برای پکیج هایش استفاده میکرد و بعد از آن تعداد زیادی از پروژه های Go شروع به کپی برداری از روی اون الگو کردند ( [`این`](https://twitter.com/bradfitz/status/1039512487538970624) توییت از Brad Fitzpatrick رو ببینید ).

### `/vendor`

&#x202b;وابستگی‌های برنامه (اونایی که به صورت دستی توسط شما یا توسط ابزار depdency mangment مورد علاقه شما مانند ابزار داخلی جدید  [`Go Modules`](https://github.com/golang/go/wiki/Modules) مدیریت میشن). دستور `go mod vendor` پوشه‌ی  `/vendor` را برای شما میسازه. توجه کنید که شاید نیاز داشته باشید فلگ (flag `mod=vendor-` را به دستور  `go build` تون اضافه کنید اگر از Go ورژن 1.14 ٬ که در آن به صورت پیش فرض فعال است ٬ استفاده نمیکنید .

&#x202b;اگر در حال ساخت لایبری هستید ٬ وابستگی های برنامه تون رو کامیت نکنید.

&#x202b;قابل ذکره که از ورژن [`1.13`](https://golang.org/doc/go1.13#modules) Go قابلیت پروکسی ماژول رو اضافه کرده (از [`https://proxy.golang.org`](https://proxy.golang.org) به عنوان ماژول پراکسی پیش فرض استفاده میشه). میتونید در موردش بیشتر  [`اینجا`](https://blog.golang.org/module-mirror-launch) بخونید برای اینکه ببینید آیا با تمام نیازها و محدودیت های شما مطابقت دارد یا نه. که اگر مطابقت داشته به پوشه ی `vendor` به طور کل نیازی ندارید.

## پوشه‌های سرویس برنامه

### `/api`

&#x202b;مشخصات OpenAPI/Swagger، فایل های JSON schema، فایل های تعریف پروتکل.

&#x202b;برای مثال‌های بیشتر پوشه  [`/api`](api/README.md) رو ببینید.

## پوشه های وب اپلیکیشن ها

### `/web`

&#x202b;اجزا ی اختصاصی وب اپلیکیشن : asset های استاتیک وب , templateهای سمت سرور و SPAها.

## پوشه های رایج برنامه

### `/configs`

&#x202b;پیکربندی قالب های فایل یا پیکربندی های پیش فرض .

&#x202b;فایل `confd` یا `consul-template` های خود را در اینجا قرار دهید.

### `/init`

&#x202b;مقداردهی های اولیه ی سیستم (systemd, upstart, sysv) و تنظیمات پراسس منیجر ها (runit, supervisord) .

### `/scripts`

&#x202b;اسکریپت هایی برای انجام عملیات های مثله: ساخت، نصب، تجزیه و تحلیل و غیره به کار میره.

&#x202b;این اسکریپت ها، Makefile کف پروژه رو (root) را کوچک و ساده نگه میداره(مثال [`https://github.com/hashicorp/terraform/blob/master/Makefile`](https://github.com/hashicorp/terraform/blob/master/Makefile)).

&#x202b;برای مثال های بیشتر  [`/scripts`](scripts/README.md) رو ببینید

### `/build`

&#x202b;بسته بندی و ادغام مداوم (Packaging and Continuous Integration).

&#x202b;تنظیمات سرور ابری  (AMI), کانتینر (Docker), سیستم عامل (deb, rpm, pkg) خودتون رو در پوشه‌ی  `/build/package` قرار بدید.

&#x202b;تنظیمات و اسکریپت های CI (travis, circle, drone) خودتون رو در پوشه‌ی  `/build/ci` قرار بدید. توجه کنید که بعضی از ابزار های CI(مثل  Travis CI) در مورد پوشه‌ی پیکربندی هایشان خیلی حساس‌ اند. سعی کنید فایل های تنظیمات رو در پوشه‌ی `/build/ci` قرار بدید و به پوشه ای که ابزار CI انتظار دارد آن ها را در آنجا بیابد وصلشون کنید (زمانی که ممکنه).

### `/deployments`

&#x202b;پیکربندی ها و الگوهای استقرار سیستم IaaS، PaaS و container orchestration (docker-compose, kubernetes/helm, mesos, terraform, bosh). توجه کنید که در گروهی از ریپازیتوری ها (مخصوصا آن هایی که با kubernates دیپلوی شده اند) این پوشه `/deploy` نام دارد.

قالب‌های IaaS، PaaS، پیکربندی‌ها و پیاده‌سازی container orchestration و کانتینر (docker-compose، kubernetes/helm، terraform) توجه داشته باشید که تو بعضی از ریپوها (مخصوصاً برنامه هایی که با kubernetes دیپلوی شده اند) این دایرکتوری رو «/deploy» بهش میگن.

### `/test`

&#x202b;برنامه‌های تست اضافی و داده‌های تست. هر طور که تمایل داشتید پوشه ی  `/test` را ساختار بندی کنید. برای پروژه های بزرگتر داشتن یک پوشه data منطقیه. بطور مثال میتونید `/test/data` یا `/test/testdata` را استفاده کنید و اگر میخواهید که Go داده‌ها را نادیده بگیره. توجه کنید که Go فایل‌ها یا پوشه‌هایی که با  "." یا "_" شروع شده اند رو نادیده میگیره, بنابراین از نظر نحوه نامگذاری پوشه های دیتای تست خود انعطاف بیشتری دارید.

&#x202b;برای مثال های بیشتر [`/test`](test/README.md) رو ببینید.

## بقیه‌ی پوشه‌ ها

### `/docs`

&#x202b;طراحی ها و مستندات کاربر (مازاد بر مستندات ایجاد شده توسط godoc).

&#x202b;برای مثال های بیشتر [`/docs`](docs/README.md) رو ببینید.

### `/tools`

&#x202b;ابزارهای پشتیبانی شده در این پروژه. یادتون باشه که این ابزارها می توننن از دایرکتوری های `/pkg` و `/internal` ایمپورت شن.

&#x202b;برای مثال های بیشتر  [`/tools`](tools/README.md) رو ببینید.

### `/examples`

&#x202b;مثال های برنامه ها و/یا کتابخانه های عمومی شما.


&#x202b;برای مثال های بیشتر  [`/examples`](examples/README.md) رو ببینید.

### `/third_party`

&#x202b;ابزارهای کمکی بیرونی، کد فورک شده و سایر ابزارهای شخص ثالث (مثل Swagger UI).

### `/githooks`

&#x202b;هوک‌های گیت.

### `/assets`

&#x202b;سایر asset ها برای همراهی با repo شما (مثل تصاویر، لوگو‌ها و غیره).

### `/website`

&#x202b;اگر از  GitHub Pages استفاده نمی کنید، اینجا جاییست که می توانید داده های وب سایت پروژه خود را قرار دهید.

&#x202b;برای مثال های بیشتر  [`/website`](website/README.md) رو ببینید.

## پوشه هایی که نباید داشته باشید

### `/src`

&#x202b; بعضی از پروژه های Go پوشه‌ی  `src` را دارند, ولی معمولا این زمانی اتفاق میافتد که توسعه دهنده از دنیای جاوا آمده باشد که در اونجا این الگو الگوی رایجه. اگر می تونید بیاید و به خودتون کمک کنید و سعی کنید از این الگوی جاوا استفاده نکنید. شما واقعاً نمیخواید کد یا پروژه‌ی Goی شما شبیه  به جاوا باشد :-)

&#x202b;این پوشه  `/src` که در سطح پوشه بندی پروژه قرار دارد را با پوشه ی `src/` که Go در اینجا ([`How to Write Go Code`](https://golang.org/doc/code.html)) برای workspaces خود استفاده می کند اشتباه نگیرید. متغیر envی  `$GOPATH` اشاره میکنه به محیط کاری (فعلی) شما یا workspace  (در سیستم عامل های غیر از ویندوز به صورت پیش فرض به `$HOME/go` اشاره میکند). این فضای کاری شامل پوشه های سطح بالای `/pkg` ٬ `bin` و `/src` می شود. پروژه ی شما در نهایت زیرمجموعه پوشه ی  `/src` قرار میگیرد ٬ پس اگر شما پوشه ی `/src` در پروژه ی خود داشته باشید مسیر پروژه ی شما به این صورت در می آید: `/some/path/to/workspace/src/your_project/src/your_code.go`. توجه داشته باشید که در Go ورژن 1.11 میتونید خارج از `GOPATH` پروژه داشته باشید ٬ اما هنوز به این معنی نیست که استفاده از این الگوی چیدمان ایده خوبی است.


## نشان‌ها

&#x202b;* [Go Report Card](https://goreportcard.com/) - کد شما را با `gofmt`, `go vet`, `gocyclo`, `golint`, `ineffassign`, `license` و `misspell` اسکن میکنه. `github.com/golang-standards/project-layout` را با آدزس پروژه خود تعویض کنید.

&#x202b; [![Go Report Card](https://goreportcard.com/badge/github.com/golang-standards/project-layout?style=flat-square)](https://goreportcard.com/report/github.com/golang-standards/project-layout)

&#x202b;* ~~[GoDoc](http://godoc.org) - این نسخه آنلاین مستندات تولید شده GoDoc شما را ارائه می دهد. لینک را تغییر دهید تا به پروژه شما اشاره کند.~~

&#x202b;  [![Go Doc](https://img.shields.io/badge/godoc-reference-blue.svg?style=flat-square)](http://godoc.org/github.com/golang-standards/project-layout)

&#x202b;* [Pkg.go.dev](https://pkg.go.dev) - Pkg.go.dev یک مکان جدید برای اکتشاف Go و مستندات است. شما میتواد یک badge با استفاده از [badge generation tool](https://pkg.go.dev/badge) درست کنید.

&#x202b;  [![PkgGoDev](https://pkg.go.dev/badge/github.com/golang-standards/project-layout)](https://pkg.go.dev/github.com/golang-standards/project-layout)

&#x202b;* release - اخرین شماره از منتشر شده ی شما را نشان خواهد داد. لینک گیتهاب را عوض کنید تا به سمت پروژه ی شما هدایت کند.

&#x202b;  [![Release](https://img.shields.io/github/release/golang-standards/project-layout.svg?style=flat-square)](https://github.com/golang-standards/project-layout/releases/latest)

## &#x202b; یادداشت

&#x202b; یک قالب پروژه ی دارای چارچوب با مثال ها یا تنظیمات قابل استفاده مجدد٬ اسکریپت و کد های بیشتر در دست ساخت است
